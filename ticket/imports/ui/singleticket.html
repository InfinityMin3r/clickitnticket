<!-- 
This page displays a single ticket and comments.  Certain fields are restricted to authenticated viewers,
as is the resolve button and comment add field.
-->

<template name="singleticket">
  {{#if currentUser}}
    <a href="/view" class="btn btn-info" style="margin-bottom: 10px" >Return to Ticket List</a>
  {{/if}}
  <br />
  <!-- This section displays the info for the ticket -->
  <div class="container ticket-list">
    <label><h1><span id="ticketnum">{{number}}</span></h1></label>
    <li>
      <p><strong>Created at:</strong> {{createdAt}}</p>
      <p><strong>Reported by:</strong> {{rpiemail}}</p>
      {{#if currentUser}}
        <p><strong>Submitted By:</strong> {{youremail}}</p>
      {{/if}}
      <p><strong>Issue Type:</strong> {{issuetype}}</p>
      {{#if currentUser}}
        <p><strong>Priority:</strong> {{priority}}</p>
      {{/if}}
      <p><strong>Description:</strong> {{description}}</p>
      <p><strong>Status: </strong> 
        {{#if status}}
          New Ticket
        {{else}}
          Resolved
        {{/if}}
      </p>
      {{#if currentUser}}
        <p><button class="btn btn-success btn-block btn-resolve">Resolve!</button></p>
      {{/if}}
    </li>
  </div>

  <!-- This section displays each existing comment and the add comment field for authenticated viewers -->
  <div>
    <h1 style="text-align: center">Comments:</h1>
      {{#each comments}}
        <div class="container ticket-list">
          <h4>{{author}}</h4>
          <p>{{{body}}}</p>
        </div>
        <br />
      {{/each}}
    {{#if currentUser}}
      <form class="container ticket-list">
        <input type="text" id="commentbody" style="width: 100%;" placeholder="Add comment..." />
      </form>
      <br />
    {{/if}}
  </div>
</template>
